@using Hades.Web.ViewModels
@model IEnumerable<Hades.Web.ViewModels.CampanhaViewModel>

@{
    ViewBag.Title = "Index";
    Layout = (bool)Session["Administrador"] ? "~/Views/Shared/_Layout.cshtml" : "~/Views/Shared/_LayoutUsuario.cshtml";
    var mensagem = TempData["mensagem"]?.ToString() ?? "";
}

<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
    <div style="background-color: white; padding: 10px; border-radius: 15px; box-shadow: 0 0 30px black; margin-top: 2%;">
        <h4>LISTA DE ENQUETES</h4>
        <div id="tabela">
            <ul>
                <li>
                    <h6 style="position: relative;color: red;float: right;top: 30px;">(Validade de 2 meses)</h6>
                    <p>
                        <a class="btn-floating red tooltipped" data-position="bottom" data-delay="50" data-tooltip="Criar Campanha"><i class="material-icons" id="Novo">playlist_add</i></a>
                    </p>
                    @*<a class="btn-floating blue"><i class="material-icons" onclick="votar()">input</i></a>*@
                </li>
            </ul>
            <div id="tabelaCampanha"></div>
        </div>
    </div>
</div>

<div id="divContentCampanhaDetail" class="modal modal-formatada-detail"></div>
<div id="divContentCampanha" class="modal modal-formatada"></div>

<script>

    $(".modal-overlay").on("click", function () {
        $(this).hide();
    });

    var mensagemAviso = '@(!string.IsNullOrEmpty(mensagem)?mensagem:"")';

    $(document).ready(function () {
        $('.modal').modal();
        $('.tooltipped').tooltip({ delay: 50 });
        $('input#input_text, textarea#textarea1').characterCounter();
    });

    var urlsEnquete = {
        @*Edit: '@Url.Action("Edit", "Campanha")',
        Details: '@Url.Action("Details", "Campanha")',
        Delete: '@Url.Action("DesativarEnquete", "Campanha")',
        Create: '@Url.Action("Create", "Campanha")',
        GetVotacao: '@Url.Action("GetVotacao", "Campanha")',*@
        BuscaTabelaCampanha: '@Url.Action("BuscaGridCampanha", "Campanha")'
    }

    var buscaTabelaEnquete = (function tabelaEnquete() {
        $.get(urlsEnquete.BuscaTabelaCampanha)
            .done(function (data) {
                $("#tabelaCampanha").html(data);
            }).fail(function (xhr) { erro(xhr.responseText); });
        return tabelaEnquete;
    })();

    mensagem(mensagemAviso);

    //$("#Novo").click(function () {
    //    $.get(urlsEnquete.Create)
    //        .done(function (data) { $('#divContentEnquete').modal('open').html(data); })
    //        .fail(function (xhr) { erro(xhr.responseText) });
    //});

    //function editar(id) {
    //    $.get(urlsEnquete.Edit, {
    //        id: id
    //    }).done(function (data) {
    //        escondeModal();
    //        $('#divContentEnquete').modal('open').html(data);
    //    }).fail(function (xhr) { erro(xhr.responseText) });
    //};

    //function detalhar(id) {
    //    $.get(urlsEnquete.Details, {
    //        id: id
    //    }).done(function (data) {
    //        escondeModal();
    //        $('#divContentEnqueteDetail').modal('open').html(data);
    //    }).fail(function (xhr) { erro(xhr.responseText) });
    //};

    //function desativar(id) {
    //    if (!confirm("Deseja realmente Desativar essa Enquete?")) return;

    //    $.get(urlsEnquete.Delete, {
    //        id: id
    //    }).done(function () {
    //        buscaTabelaEnquete();
    //    }).fail(function (xhr) {
    //        erro(xhr.responseText);
    //    });
    //};

    //var userLog = sessionStorage.getItem('IdUsuarioLogado');

    //function votar(id, tituloEnquete){
    //    $.get(urlsEnquete.GetVotacao, {
    //        IdUsuario: userLog,
    //        IdEnquete: id,
    //        Enquete: tituloEnquete
    //    }).done(function (data) {
    //        escondeModal();
    //        $('#divContentEnquete').modal('open').html(data);
    //    }).fail(function (xhr) {
    //        erro(xhr.responseText);
    //    });
    //};

    function escondeModal() {
        $("#divContentEnquete").modal('close');
        $("#divContentEnqueteDetail").modal('close');
    }

</script>
